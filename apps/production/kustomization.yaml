apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - cert-manager
  - ../base/traefik-middleware
  - ../base/podinfo
  - ../base/prometheus
  - ../base/nextcloud
  - ../base/loki-stack
  - ../base/home-assistant
patchesStrategicMerge:
  - podinfo-values.yaml
  - prometheus-values.yaml
  - nextcloud-values.yaml
  - loki-stack-values.yaml
patches:
  - target:
      kind: IngressRoute
      name: prometheus-ingress
      namespace: prometheus
    path: prometheus-ingress-patch.yaml
  - target:
      kind: IngressRoute
      name: grafana-ingress
      namespace: prometheus
    path: grafana-ingress-patch.yaml
  - target:
      kind: IngressRoute
      name: nextcloud-ingress
      namespace: nextcloud
    path: nextcloud-ingress-patch.yaml
  - target:
      kind: IngressRoute
      name: home-assistant-ingress
      namespace: home-assistant
    path: home-assistant-ingress-patch.yaml